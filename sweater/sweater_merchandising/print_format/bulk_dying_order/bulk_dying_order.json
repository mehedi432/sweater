{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-11-23 14:31:55.825384",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Order Sheet Entry",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<div style=\"font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #1a1c1e; line-height: 1.4; max-width: 1100px; margin: auto; padding: 10px; background-color: #fff;\">\n    \n    <div style=\"margin-bottom: 20px;\">\n        {{ letter_head }}\n    </div>\n\n    <div style=\"display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;\">\n        <div style=\"display: flex; align-items: center;\">\n            <div style=\"width: 5px; height: 50px; background-color: #1a1c1e; margin-right: 15px;\"></div>\n            <div>\n                <h1 style=\"margin: 0; font-size: 22px; font-weight: 800; color: #111; text-transform: uppercase; letter-spacing: 2px;\">\n                    Yarn Dyeing <span style=\"font-weight: 300;\">Order</span>\n                </h1>\n                <div style=\"font-size: 9px; color: #888; text-transform: uppercase; letter-spacing: 1.5px; margin-top: 2px; font-weight: 700;\">\n                    Supply Chain Integrity Document | SDO: <span style=\"color: #000;\">{{ doc.sdo_number }}</span>\n                </div>\n            </div>\n        </div>\n        \n        <div style=\"text-align: right;\">\n            <div style=\"background: #1a1c1e; color: #fff; padding: 6px 20px; font-size: 12px; font-weight: bold; text-transform: uppercase;\">\n                Official Booking\n            </div>\n            <div style=\"font-size: 10px; font-weight: 800; margin-top: 5px; color: #444;\">{{ doc.name }}</div>\n        </div>\n    </div>\n\n    <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 25px; font-size: 10px; table-layout: fixed; border: 1.5px solid #1a1c1e;\">\n        <tr>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Date</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ frappe.utils.formatdate(doc.posting_date or doc.creation, \"dd-MMM-yyyy\") }}</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Supplier / Dyeing House</div>\n                <div style=\"font-weight: 700; color: #b71c1c;\">{{ (doc.dyeing_house or doc.supplier or 'N/A')|upper }}</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Attention</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.attention_name or 'Production Manager' }}</div>\n            </td>\n        </tr>\n        <tr>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Style Number</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.style_no or 'N/A' }}</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Reference PI</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.reference_pi_no or 'N/A' }}</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">L/C Number</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.lc_number or 'N/A' }}</div>\n            </td>\n        </tr>\n        <tr>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Total Garments</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.sweater_quantity }} PCS</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Yarn Color</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ (doc.color or 'N/A')|upper }}</div>\n            </td>\n            <td style=\"padding: 8px; border: 1px solid #dee2e6; background: #f8f9fa;\">\n                <div style=\"color: #888; text-transform: uppercase; font-weight: 800; font-size: 8px; margin-bottom: 3px;\">Season</div>\n                <div style=\"font-weight: 700; color: #000;\">{{ doc.season or 'N/A' }}</div>\n            </td>\n        </tr>\n    </table>\n\n    <table style=\"width: 100%; border-collapse: collapse; font-size: 10.5px;\">\n        <thead>\n            <tr style=\"background-color: #1a1c1e; color: #ffffff; text-transform: uppercase; letter-spacing: 1px;\">\n                <th style=\"padding: 12px 10px; text-align: left; width: 25%;\">Color & Pantone</th>\n                <th style=\"padding: 12px 10px; text-align: center; width: 8%;\">Size</th>\n                <th style=\"padding: 12px 10px; text-align: center; width: 12%;\">Qty (Pcs)</th>\n                <th style=\"padding: 12px 10px; text-align: center; width: 12%;\">Cons (G)</th>\n                <th style=\"padding: 12px 10px; text-align: center; width: 12%;\">Price/Lb</th>\n                <th style=\"padding: 12px 10px; text-align: center; width: 8%;\">Wast.</th>\n                <th style=\"padding: 12px 10px; text-align: right; width: 23%;\">Dye Qty (Lbs)</th>\n            </tr>\n        </thead>\n        <tbody>\n            {# LOGIC TO TRACK UNIQUE YARN SPECS #}\n            {% set unique_yarns = [] %}\n            {% for item in doc.yarn_details %}\n                {% set raw_spec = item.yarn_composition or item.yarn_description or 'YARN - N/A - N/A - N/A' %}\n                {% if raw_spec not in unique_yarns %}\n                    {% set _ = unique_yarns.append(raw_spec) %}\n                {% endif %}\n            {% endfor %}\n\n            {% for yarn_group in unique_yarns %}\n                {# STRING EXTRACTION LOGIC #}\n                {% set parts = yarn_group.split(' - ') %}\n                \n                <tr>\n                    <td colspan=\"7\" style=\"padding: 25px 10px 10px 10px; text-align: center; background: #fff;\">\n                        <div style=\"font-size: 8px; color: #999; text-transform: uppercase; font-weight: 700; letter-spacing: 2px;\">Material Grade & Technical Count</div>\n                        <div style=\"font-size: 15px; font-weight: 900; color: #1a1c1e; border-bottom: 2px solid #1a1c1e; display: inline-block; padding-bottom: 4px; margin-top: 5px;\">\n                            {% if parts|length >= 4 %}\n                                {{ parts[1] }} - {{ parts[2] }} - {{ parts[3] }}\n                            {% else %}\n                                {{ yarn_group }}\n                            {% endif %}\n                        </div>\n                    </td>\n                </tr>\n\n                {% for row in doc.yarn_details %}\n                    {% set current_spec = row.yarn_composition or row.yarn_description or 'YARN - N/A - N/A - N/A' %}\n                    {% if current_spec == yarn_group %}\n                    <tr style=\"border-bottom: 1px solid #eee;\">\n                        <td style=\"padding: 12px 10px;\">\n                            <div style=\"font-weight: 700; font-size: 11px;\">{{ row.color or doc.color }}</div>\n                            <div style=\"font-size: 9px; color: #777;\">Pantone: {{ row.yarn_pantone_number or 'Standard' }}</div>\n                        </td>\n                        <td style=\"padding: 12px 10px; text-align: center; font-weight: 700;\">{{ row.size or '-' }}</td>\n                        <td style=\"padding: 12px 10px; text-align: center;\">{{ row.quantity or '-' }}</td>\n                        <td style=\"padding: 12px 10px; text-align: center;\">{{ row.consumption }}g</td>\n                        <td style=\"padding: 12px 10px; text-align: center; font-weight: 600; color: #444;\">\n                            {{ doc.currency or '$' }} {{ \"{:,.2f}\".format(row.rate|float) }}\n                        </td>\n                        <td style=\"padding: 12px 10px; text-align: center; color: #888;\">{{ row.wastage }}%</td>\n                        <td style=\"padding: 12px 10px; text-align: right; font-weight: 800; font-size: 12px;\">\n                            {{ \"{:,.3f}\".format(row.total_yarn|float) }}\n                        </td>\n                    </tr>\n                    {% endif %}\n                {% endfor %}\n            {% endfor %}\n        </tbody>\n    </table>\n    \n    <div style=\"display: flex; justify-content: flex-end; margin-top: 25px; gap: 15px;\">\n        <div style=\"width: 250px; background: #1a1c1e; padding: 15px; color: #fff;\">\n            <div style=\"font-size: 9px; font-weight: 700; color: #aaa; text-transform: uppercase;\">Estimated Yarn Value</div>\n            <div style=\"font-size: 20px; font-weight: 900;\">\n                {{ doc.currency or '$' }} {{ \"{:,.2f}\".format(doc.total_amount|float) if doc.total_amount else 'TBD' }}\n            </div>\n        </div>\n        <div style=\"width: 250px; background: #f8f9fa; padding: 15px; border: 1.5px solid #dee2e6;\">\n            <div style=\"font-size: 9px; font-weight: 700; color: #888; text-transform: uppercase;\">Total Booking Weight</div>\n            <div style=\"font-size: 20px; font-weight: 900; color: #1a1c1e;\">\n                {{ \"{:,.3f}\".format(doc.total_required_yarn|float) }} <span style=\"font-size: 10px;\">LBS</span>\n            </div>\n        </div>\n        \n    </div>\n\n    <div style=\"margin-top: 80px; display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; text-align: center; font-size: 9px; text-transform: uppercase; font-weight: bold;\">\n        <div>\n            <div style=\"height: 40px;\"></div>\n            <div style=\"border-top: 1px solid #ccc; padding-top: 8px;\">Prepared By<br><span style=\"font-weight: normal; color: #888; text-transform: none;\">{{ frappe.get_fullname(doc.owner) }}</span></div>\n        </div>\n        <div>\n            <div style=\"height: 40px;\"></div>\n            <div style=\"border-top: 1px solid #ccc; padding-top: 8px;\">Merchandising</div>\n        </div>\n        <div>\n            <div style=\"height: 40px;\"></div>\n            <div style=\"border-top: 1px solid #ccc; padding-top: 8px;\">Checked By</div>\n        </div>\n        <div>\n            <div style=\"height: 40px;\"></div>\n            <div style=\"border-top: 1px solid #ccc; padding-top: 8px; color: #000;\">Authorized Approval</div>\n        </div>\n    </div>\n\n    <div style=\"margin-top: 50px; border-top: 1px solid #eee; padding-top: 15px; display: flex; justify-content: space-between; align-items: center;\">\n        <div>\n            <p style=\"font-size: 9px; color: #999; text-transform: uppercase; letter-spacing: 1px; margin: 0; font-weight: 800;\">Meek Sweater & Fashions Ltd.</p>\n            <p style=\"font-size: 8px; color: #bbb; margin: 2px 0 0 0;\">ERP Data Source &bull; {{ frappe.utils.now_datetime().strftime('%d-%m-%Y %I:%M %p') }}</p>\n        </div>\n        <img src=\"https://api.qrserver.com/v1/create-qr-code/?size=50x50&data={{ frappe.utils.get_url() }}/app/order-sheet-entry/{{ doc.name }}\" \n             style=\"width: 45px; height: 45px; filter: grayscale(100%); opacity: 0.6; border: 1px solid #eee; padding: 2px;\">\n    </div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2026-02-13 00:17:34.025330",
 "modified_by": "Administrator",
 "module": "Sweater Merchandising",
 "name": "BULK DYING ORDER",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_for": "DocType",
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}